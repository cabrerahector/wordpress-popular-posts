var wpp_params=document.currentScript.dataset;
var WordPressPopularPosts=function(){var noop=function(){};var get=function(url,params,callback,additional_headers){callback="function"===typeof callback?callback:noop;ajax("GET",url,params,callback,additional_headers)};var post=function(url,params,callback,additional_headers){callback="function"===typeof callback?callback:noop;ajax("POST",url,params,callback,additional_headers)};var ajax=function(method,url,params,callback,additional_headers){var xhr=new XMLHttpRequest;var target=url;var args=params;
var valid_methods=["GET","POST"];var headers={"X-Requested-With":"XMLHttpRequest"};method=-1!=valid_methods.indexOf(method)?method:"GET";if("POST"==method)headers["Content-Type"]="application/x-www-form-urlencoded";if("object"==typeof additional_headers&&Object.keys(additional_headers).length)headers=Object.assign({},headers,additional_headers);xhr.open(method,target+("GET"==method?"?"+args:""),true);var key;for(key in headers)if(headers.hasOwnProperty(key))xhr.setRequestHeader(key,headers[key]);
xhr.onreadystatechange=function(){if(4===xhr.readyState&&200<=xhr.status&&300>xhr.status)if("function"===typeof callback)callback.call(undefined,xhr.response)};xhr.send("POST"==method?args:null)};var theme=function(wpp_list){var base_styles=document.createElement("style");var dummy_list=document.createElement("ul");dummy_list.innerHTML='<li><a href="#"></a></li>';wpp_list.parentNode.appendChild(dummy_list);var dummy_list_item_styles=getComputedStyle(dummy_list.querySelector("li"));var dummy_link_item_styles=
getComputedStyle(dummy_list.querySelector("li a"));base_styles.innerHTML=".wpp-list li {font-size: "+dummy_list_item_styles.fontSize+"}";base_styles.innerHTML+=".wpp-list li a {color: "+dummy_link_item_styles.color+"}";wpp_list.parentNode.removeChild(dummy_list);var wpp_list_sr=wpp_list.attachShadow({mode:"open"});wpp_list_sr.append(base_styles);for(;wpp_list.firstElementChild;)wpp_list_sr.append(wpp_list.firstElementChild)};return{get:get,post:post,ajax:ajax,theme:theme}}();
(function(){var post_id=Number(wpp_params.postId);var do_request=true;if(post_id){if("1"==wpp_params.sampling){var num=Math.floor(Math.random()*wpp_params.samplingRate)+1;do_request=1===num}if(do_request)WordPressPopularPosts.post(wpp_params.apiUrl+"/v2/views/"+post_id,"_wpnonce="+wpp_params.token+"&sampling="+wpp_params.sampling+"&sampling_rate="+wpp_params.samplingRate,function(response){wpp_params.debug&&window.console&&window.console.log&&window.console.log(JSON.parse(response))})}})();
document.addEventListener("DOMContentLoaded",function(){function fetchWidget(widget_placeholder){var widget_id_attr=widget_placeholder.getAttribute("data-widget-id");var method="GET";var url="";var headers={"X-WP-Nonce":wpp_params.token};var params="";if(widget_id_attr){url=wpp_params.apiUrl+"/v1/popular-posts/widget/"+widget_id_attr.split("-")[1];params="is_single="+wpp_params.postId+(wpp_params.lang?"&lang="+wpp_params.lang:"")}else{method="POST";url=wpp_params.apiUrl+"/v2/widget?is_single="+wpp_params.postId+
(wpp_params.lang?"&lang="+wpp_params.lang:"");headers["Content-Type"]="application/json";var json_tag=widget_placeholder.parentNode.querySelector('script[type="application/json"]');if(json_tag){var args=JSON.parse(json_tag.textContent.replace(/[\n\r]/g,""));params=JSON.stringify(args)}}WordPressPopularPosts.ajax(method,url,params,function(response){renderWidget(response,widget_placeholder)},headers)}function renderWidget(response,widget_placeholder){widget_placeholder.insertAdjacentHTML("afterend",
JSON.parse(response).widget);var parent=widget_placeholder.parentNode;var sr=parent.querySelector(".popular-posts-sr");var json_tag=parent.querySelector('script[type="application/json"]');if(json_tag)parent.removeChild(json_tag);parent.removeChild(widget_placeholder);parent.classList.add("wpp-ajax");if(sr)WordPressPopularPosts.theme(sr);var event=new Event("wpp-onload",{"bubbles":true,"cancelable":false});parent.dispatchEvent(event)}var widget_placeholders=document.querySelectorAll(".wpp-widget-placeholder, .wpp-widget-block-placeholder, .wpp-shortcode-placeholder");
var w=0;for(;w<widget_placeholders.length;){fetchWidget(widget_placeholders[w]);w++}var sr=document.querySelectorAll(".popular-posts-sr");if(sr.length){var s=0;for(;s<sr.length;s++)WordPressPopularPosts.theme(sr[s])}});